//! This test compares the Rust port's output with the output from
//! the following C program:
//!
//! ```C
//! #include <cerf.h>
//! #include <stdio.h>
//! #include <complex.h>
//!
//! int main() {
//!     double x = 0.0;
//!     for (int i = 0; i < 1000; i++) {
//!         x += 0.1;
//!         double res = erfcx(x);
//!         printf("%17lf,\n", res);
//!     }
//! }
//! ```
//!
//! This can be compiled with the following command:
//! ```bash
//! gcc -o myprogram myprogram.c -lcerf -lm
//! ```

use puruspe::complex::erfcx;

const MAX_ERR: f64 = 1e-6;

#[test]
fn test_erfcx() {
    let mut x = 0.;
    for i in 0..1000 {
        x += 0.1;
        let res = erfcx(x);
        let libcerf_val = ERFCX_TABLE[i];

        assert!((libcerf_val - res).abs() < MAX_ERR);
    }
}

const ERFCX_TABLE: [f64; 1000] = [
    0.896457, 0.809020, 0.734599, 0.670788, 0.615690, 0.567805, 0.525930, 0.489101, 0.456532,
    0.427584, 0.401730, 0.378537, 0.357643, 0.338744, 0.321585, 0.305953, 0.291663, 0.278560,
    0.266509, 0.255396, 0.245119, 0.235593, 0.226742, 0.218499, 0.210806, 0.203613, 0.196874,
    0.190549, 0.184602, 0.179001, 0.173718, 0.168728, 0.164007, 0.159535, 0.155294, 0.151265,
    0.147435, 0.143789, 0.140314, 0.136999, 0.133834, 0.130808, 0.127914, 0.125142, 0.122485,
    0.119936, 0.117490, 0.115139, 0.112879, 0.110705, 0.108611, 0.106594, 0.104649, 0.102773,
    0.100962, 0.099213, 0.097523, 0.095888, 0.094307, 0.092777, 0.091294, 0.089858, 0.088466,
    0.087116, 0.085806, 0.084534, 0.083299, 0.082100, 0.080934, 0.079800, 0.078698, 0.077625,
    0.076581, 0.075564, 0.074574, 0.073609, 0.072668, 0.071752, 0.070857, 0.069985, 0.069134,
    0.068303, 0.067492, 0.066699, 0.065925, 0.065169, 0.064429, 0.063706, 0.062999, 0.062308,
    0.061631, 0.060969, 0.060321, 0.059686, 0.059065, 0.058456, 0.057860, 0.057275, 0.056702,
    0.056141, 0.055590, 0.055051, 0.054521, 0.054002, 0.053492, 0.052992, 0.052501, 0.052019,
    0.051545, 0.051081, 0.050624, 0.050176, 0.049735, 0.049302, 0.048877, 0.048458, 0.048047,
    0.047643, 0.047245, 0.046854, 0.046470, 0.046091, 0.045719, 0.045353, 0.044992, 0.044637,
    0.044288, 0.043944, 0.043605, 0.043272, 0.042944, 0.042620, 0.042301, 0.041987, 0.041678,
    0.041373, 0.041073, 0.040777, 0.040485, 0.040197, 0.039914, 0.039634, 0.039358, 0.039086,
    0.038818, 0.038553, 0.038292, 0.038034, 0.037780, 0.037530, 0.037282, 0.037038, 0.036797,
    0.036559, 0.036324, 0.036092, 0.035863, 0.035637, 0.035414, 0.035193, 0.034976, 0.034761,
    0.034548, 0.034338, 0.034131, 0.033926, 0.033724, 0.033524, 0.033326, 0.033130, 0.032937,
    0.032747, 0.032558, 0.032371, 0.032187, 0.032005, 0.031824, 0.031646, 0.031470, 0.031296,
    0.031123, 0.030953, 0.030784, 0.030617, 0.030452, 0.030289, 0.030128, 0.029968, 0.029810,
    0.029653, 0.029498, 0.029345, 0.029194, 0.029043, 0.028895, 0.028748, 0.028602, 0.028458,
    0.028316, 0.028174, 0.028035, 0.027896, 0.027759, 0.027623, 0.027489, 0.027356, 0.027224,
    0.027093, 0.026964, 0.026836, 0.026709, 0.026583, 0.026459, 0.026335, 0.026213, 0.026092,
    0.025972, 0.025853, 0.025735, 0.025619, 0.025503, 0.025388, 0.025275, 0.025162, 0.025050,
    0.024940, 0.024830, 0.024721, 0.024614, 0.024507, 0.024401, 0.024296, 0.024192, 0.024089,
    0.023986, 0.023885, 0.023784, 0.023685, 0.023586, 0.023488, 0.023390, 0.023294, 0.023198,
    0.023103, 0.023009, 0.022916, 0.022823, 0.022731, 0.022640, 0.022550, 0.022460, 0.022371,
    0.022283, 0.022195, 0.022108, 0.022022, 0.021936, 0.021851, 0.021767, 0.021684, 0.021601,
    0.021518, 0.021437, 0.021356, 0.021275, 0.021195, 0.021116, 0.021037, 0.020959, 0.020882,
    0.020805, 0.020728, 0.020652, 0.020577, 0.020502, 0.020428, 0.020355, 0.020281, 0.020209,
    0.020137, 0.020065, 0.019994, 0.019924, 0.019854, 0.019784, 0.019715, 0.019646, 0.019578,
    0.019510, 0.019443, 0.019377, 0.019310, 0.019244, 0.019179, 0.019114, 0.019050, 0.018986,
    0.018922, 0.018859, 0.018796, 0.018734, 0.018672, 0.018610, 0.018549, 0.018488, 0.018428,
    0.018368, 0.018308, 0.018249, 0.018190, 0.018132, 0.018074, 0.018016, 0.017959, 0.017902,
    0.017845, 0.017789, 0.017733, 0.017678, 0.017622, 0.017567, 0.017513, 0.017459, 0.017405,
    0.017351, 0.017298, 0.017245, 0.017193, 0.017141, 0.017089, 0.017037, 0.016986, 0.016935,
    0.016884, 0.016834, 0.016784, 0.016734, 0.016685, 0.016636, 0.016587, 0.016538, 0.016490,
    0.016442, 0.016394, 0.016346, 0.016299, 0.016252, 0.016206, 0.016159, 0.016113, 0.016067,
    0.016022, 0.015976, 0.015931, 0.015886, 0.015842, 0.015797, 0.015753, 0.015709, 0.015666,
    0.015623, 0.015579, 0.015537, 0.015494, 0.015451, 0.015409, 0.015367, 0.015326, 0.015284,
    0.015243, 0.015202, 0.015161, 0.015120, 0.015080, 0.015040, 0.015000, 0.014960, 0.014920,
    0.014881, 0.014842, 0.014803, 0.014764, 0.014726, 0.014687, 0.014649, 0.014611, 0.014574,
    0.014536, 0.014499, 0.014462, 0.014425, 0.014388, 0.014351, 0.014315, 0.014279, 0.014243,
    0.014207, 0.014171, 0.014136, 0.014100, 0.014065, 0.014030, 0.013995, 0.013961, 0.013926,
    0.013892, 0.013858, 0.013824, 0.013790, 0.013757, 0.013723, 0.013690, 0.013657, 0.013624,
    0.013591, 0.013558, 0.013526, 0.013493, 0.013461, 0.013429, 0.013397, 0.013366, 0.013334,
    0.013303, 0.013271, 0.013240, 0.013209, 0.013178, 0.013148, 0.013117, 0.013087, 0.013056,
    0.013026, 0.012996, 0.012966, 0.012937, 0.012907, 0.012878, 0.012848, 0.012819, 0.012790,
    0.012761, 0.012732, 0.012704, 0.012675, 0.012647, 0.012619, 0.012590, 0.012562, 0.012534,
    0.012507, 0.012479, 0.012451, 0.012424, 0.012397, 0.012370, 0.012343, 0.012316, 0.012289,
    0.012262, 0.012236, 0.012209, 0.012183, 0.012156, 0.012130, 0.012104, 0.012078, 0.012053,
    0.012027, 0.012001, 0.011976, 0.011950, 0.011925, 0.011900, 0.011875, 0.011850, 0.011825,
    0.011801, 0.011776, 0.011751, 0.011727, 0.011703, 0.011678, 0.011654, 0.011630, 0.011606,
    0.011583, 0.011559, 0.011535, 0.011512, 0.011488, 0.011465, 0.011442, 0.011419, 0.011395,
    0.011372, 0.011350, 0.011327, 0.011304, 0.011282, 0.011259, 0.011237, 0.011214, 0.011192,
    0.011170, 0.011148, 0.011126, 0.011104, 0.011082, 0.011060, 0.011039, 0.011017, 0.010996,
    0.010974, 0.010953, 0.010932, 0.010911, 0.010890, 0.010869, 0.010848, 0.010827, 0.010806,
    0.010786, 0.010765, 0.010745, 0.010724, 0.010704, 0.010683, 0.010663, 0.010643, 0.010623,
    0.010603, 0.010583, 0.010563, 0.010544, 0.010524, 0.010505, 0.010485, 0.010466, 0.010446,
    0.010427, 0.010408, 0.010388, 0.010369, 0.010350, 0.010331, 0.010313, 0.010294, 0.010275,
    0.010256, 0.010238, 0.010219, 0.010201, 0.010182, 0.010164, 0.010146, 0.010127, 0.010109,
    0.010091, 0.010073, 0.010055, 0.010037, 0.010020, 0.010002, 0.009984, 0.009966, 0.009949,
    0.009931, 0.009914, 0.009897, 0.009879, 0.009862, 0.009845, 0.009828, 0.009811, 0.009793,
    0.009777, 0.009760, 0.009743, 0.009726, 0.009709, 0.009693, 0.009676, 0.009659, 0.009643,
    0.009626, 0.009610, 0.009594, 0.009577, 0.009561, 0.009545, 0.009529, 0.009513, 0.009497,
    0.009481, 0.009465, 0.009449, 0.009433, 0.009418, 0.009402, 0.009386, 0.009371, 0.009355,
    0.009340, 0.009324, 0.009309, 0.009293, 0.009278, 0.009263, 0.009248, 0.009233, 0.009218,
    0.009203, 0.009188, 0.009173, 0.009158, 0.009143, 0.009128, 0.009113, 0.009099, 0.009084,
    0.009069, 0.009055, 0.009040, 0.009026, 0.009011, 0.008997, 0.008983, 0.008968, 0.008954,
    0.008940, 0.008926, 0.008912, 0.008898, 0.008884, 0.008870, 0.008856, 0.008842, 0.008828,
    0.008814, 0.008801, 0.008787, 0.008773, 0.008760, 0.008746, 0.008733, 0.008719, 0.008706,
    0.008692, 0.008679, 0.008665, 0.008652, 0.008639, 0.008626, 0.008613, 0.008599, 0.008586,
    0.008573, 0.008560, 0.008547, 0.008534, 0.008522, 0.008509, 0.008496, 0.008483, 0.008470,
    0.008458, 0.008445, 0.008432, 0.008420, 0.008407, 0.008395, 0.008382, 0.008370, 0.008357,
    0.008345, 0.008333, 0.008320, 0.008308, 0.008296, 0.008284, 0.008272, 0.008260, 0.008248,
    0.008235, 0.008223, 0.008211, 0.008200, 0.008188, 0.008176, 0.008164, 0.008152, 0.008140,
    0.008129, 0.008117, 0.008105, 0.008094, 0.008082, 0.008071, 0.008059, 0.008048, 0.008036,
    0.008025, 0.008013, 0.008002, 0.007991, 0.007979, 0.007968, 0.007957, 0.007946, 0.007934,
    0.007923, 0.007912, 0.007901, 0.007890, 0.007879, 0.007868, 0.007857, 0.007846, 0.007835,
    0.007824, 0.007814, 0.007803, 0.007792, 0.007781, 0.007770, 0.007760, 0.007749, 0.007738,
    0.007728, 0.007717, 0.007707, 0.007696, 0.007686, 0.007675, 0.007665, 0.007655, 0.007644,
    0.007634, 0.007623, 0.007613, 0.007603, 0.007593, 0.007583, 0.007572, 0.007562, 0.007552,
    0.007542, 0.007532, 0.007522, 0.007512, 0.007502, 0.007492, 0.007482, 0.007472, 0.007462,
    0.007452, 0.007442, 0.007433, 0.007423, 0.007413, 0.007403, 0.007394, 0.007384, 0.007374,
    0.007365, 0.007355, 0.007346, 0.007336, 0.007327, 0.007317, 0.007308, 0.007298, 0.007289,
    0.007279, 0.007270, 0.007261, 0.007251, 0.007242, 0.007233, 0.007223, 0.007214, 0.007205,
    0.007196, 0.007187, 0.007177, 0.007168, 0.007159, 0.007150, 0.007141, 0.007132, 0.007123,
    0.007114, 0.007105, 0.007096, 0.007087, 0.007078, 0.007069, 0.007061, 0.007052, 0.007043,
    0.007034, 0.007025, 0.007017, 0.007008, 0.006999, 0.006991, 0.006982, 0.006973, 0.006965,
    0.006956, 0.006948, 0.006939, 0.006931, 0.006922, 0.006914, 0.006905, 0.006897, 0.006888,
    0.006880, 0.006871, 0.006863, 0.006855, 0.006846, 0.006838, 0.006830, 0.006822, 0.006813,
    0.006805, 0.006797, 0.006789, 0.006781, 0.006772, 0.006764, 0.006756, 0.006748, 0.006740,
    0.006732, 0.006724, 0.006716, 0.006708, 0.006700, 0.006692, 0.006684, 0.006676, 0.006668,
    0.006661, 0.006653, 0.006645, 0.006637, 0.006629, 0.006621, 0.006614, 0.006606, 0.006598,
    0.006591, 0.006583, 0.006575, 0.006568, 0.006560, 0.006552, 0.006545, 0.006537, 0.006530,
    0.006522, 0.006514, 0.006507, 0.006499, 0.006492, 0.006485, 0.006477, 0.006470, 0.006462,
    0.006455, 0.006447, 0.006440, 0.006433, 0.006425, 0.006418, 0.006411, 0.006404, 0.006396,
    0.006389, 0.006382, 0.006375, 0.006367, 0.006360, 0.006353, 0.006346, 0.006339, 0.006332,
    0.006325, 0.006318, 0.006310, 0.006303, 0.006296, 0.006289, 0.006282, 0.006275, 0.006268,
    0.006261, 0.006254, 0.006248, 0.006241, 0.006234, 0.006227, 0.006220, 0.006213, 0.006206,
    0.006200, 0.006193, 0.006186, 0.006179, 0.006172, 0.006166, 0.006159, 0.006152, 0.006145,
    0.006139, 0.006132, 0.006125, 0.006119, 0.006112, 0.006106, 0.006099, 0.006092, 0.006086,
    0.006079, 0.006073, 0.006066, 0.006060, 0.006053, 0.006047, 0.006040, 0.006034, 0.006027,
    0.006021, 0.006014, 0.006008, 0.006002, 0.005995, 0.005989, 0.005983, 0.005976, 0.005970,
    0.005964, 0.005957, 0.005951, 0.005945, 0.005939, 0.005932, 0.005926, 0.005920, 0.005914,
    0.005907, 0.005901, 0.005895, 0.005889, 0.005883, 0.005877, 0.005871, 0.005864, 0.005858,
    0.005852, 0.005846, 0.005840, 0.005834, 0.005828, 0.005822, 0.005816, 0.005810, 0.005804,
    0.005798, 0.005792, 0.005786, 0.005780, 0.005774, 0.005769, 0.005763, 0.005757, 0.005751,
    0.005745, 0.005739, 0.005733, 0.005728, 0.005722, 0.005716, 0.005710, 0.005704, 0.005699,
    0.005693, 0.005687, 0.005681, 0.005676, 0.005670, 0.005664, 0.005659, 0.005653, 0.005647,
    0.005642,
];
