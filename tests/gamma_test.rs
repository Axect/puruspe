use approx::assert_abs_diff_eq;
use puruspe::{
    ln_gamma,
    gamma
};

const LN_GAMMA_TABLE: [(f64, f64); 19] = [
    (1.0000000000000001e-01, 2.2527126517342060e+00),
    (2.0000000000000001e-01, 1.5240638224307845e+00),
    (5.0000000000000000e-01, 5.7236494292469997e-01),
    (1.0000000000000000e+00, 0.0000000000000000e+00),
    (1.5000000000000000e+00, -1.2078223763524526e-01),
    (2.0000000000000000e+00, 0.0000000000000000e+00),
    (2.5000000000000000e+00, 2.8468287047291918e-01),
    (3.0000000000000000e+00, 6.9314718055994529e-01),
    (4.0000000000000000e+00, 1.7917594692280550e+00),
    (5.0000000000000000e+00, 3.1780538303479458e+00),
    (1.0000000000000000e+01, 1.2801827480081469e+01),
    (2.0000000000000000e+01, 3.9339884187199495e+01),
    (5.0000000000000000e+01, 1.4456574394634487e+02),
    (2.5000000000000000e-01, 1.2880225246980774e+00),
    (7.5000000000000000e-01, 2.0328095143129538e-01),
    (1.0000000000000001e-05, 1.1512919692895826e+01),
    (1.0000000000000000e-10, 2.3025850929882733e+01),
    (1.0000000000000000e+05, 1.0512877089736569e+06),
    (1.0000000000000000e+10, 2.2025850928881058e+11),
];

#[test]
fn test_ln_gamma() {
    for (x, y) in LN_GAMMA_TABLE {
        let eps = if x <= 1e-6 {
            1e-6
        } else if x >= 1e+3 {
            x * 1e-13
        } else {
            1e-10
        };
        assert_abs_diff_eq!(ln_gamma(x), y, epsilon = eps);
    }
}

const GAMMA_TABLE: [(f64, f64); 21] = [
    (-1.5000000000000000e+00, 2.3632718012073548e+00),
    (-5.0000000000000000e-01, -3.5449077018110318e+00),
    (1.0000000000000001e-01, 9.5135076986687324e+00),
    (2.0000000000000001e-01, 4.5908437119988035e+00),
    (5.0000000000000000e-01, 1.7724538509055159e+00),
    (1.0000000000000000e+00, 1.0000000000000000e+00),
    (1.5000000000000000e+00, 8.8622692545275794e-01),
    (2.0000000000000000e+00, 1.0000000000000000e+00),
    (2.5000000000000000e+00, 1.3293403881791370e+00),
    (3.0000000000000000e+00, 2.0000000000000000e+00),
    (4.0000000000000000e+00, 6.0000000000000000e+00),
    (5.0000000000000000e+00, 2.4000000000000000e+01),
    (1.0000000000000000e+01, 3.6288000000000000e+05),
    (2.0000000000000000e+01, 1.2164510040883200e+17),
    (5.0000000000000000e+01, 6.0828186403426752e+62),
    (2.5000000000000000e-01, 3.6256099082219082e+00),
    (7.5000000000000000e-01, 1.2254167024651774e+00),
    (1.0000000000000001e-05, 9.9999422794225538e+04),
    (1.0000000000000000e-10, 9.9999999994227848e+09),
    (1.0000000000000000e+02, 9.3326215443944172e+155),
    (1.7000000000000000e+02, 4.2690680090047061e+304),
];

#[test]
fn test_gamma() {
    for (x, y) in GAMMA_TABLE {
        //let eps = if x <= 1e-6 {
        //    1e-6
        //} else if x >= 1e+3 {
        //    x * 1e-13
        //} else {
        //    1e-10
        //};
        let eps = 1e-10;
        assert_abs_diff_eq!(gamma(x), y, epsilon = eps);
    }
}
